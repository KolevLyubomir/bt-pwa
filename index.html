<!doctype html>
<html lang="bg">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>БТ App 5 — v5.1.9</title>

  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"/>
  <meta http-equiv="Pragma" content="no-cache"/>
  <meta http-equiv="Expires" content="0"/>

  <meta name="theme-color" content="#0b1215"/>
  <link rel="manifest" href="manifest.webmanifest?v=1.39"/>
  <link rel="icon" href="assets/icons/icon-192.png?v=1.39"/>

  <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Great+Vibes&family=Marcellus&family=Montserrat:wght@400;600;700&display=swap"/>

  <link rel="stylesheet" href="assets/css/main.css"/>
  <link rel="stylesheet" href="assets/css/data.css"/>

  <link rel="stylesheet" href="assets/css/program-layout.css?v=5.1.9"/>
  <link rel="stylesheet" href="assets/css/program-states.css?v=5.1.9"/>
  <link rel="stylesheet" href="assets/css/program-buttons.css?v=5.1.9"/>
  <link rel="stylesheet" href="assets/css/program-clock.css?v=5.1.9"/>
  <link rel="stylesheet" href="assets/css/program-dialogs.css?v=5.1.9"/>
</head>
<body>

  <div class="topbar-wrap">
    <div class="topbar">
      <div class="app-title">Безопасно тегло</div>
      <div class="tabs">
        <button id="tab-data" class="tab-btn" type="button">Данни</button>
        <button id="tab-program" class="tab-btn" type="button" aria-selected="true">Програма</button>
      </div>
    </div>
  </div>

  <div id="panel-data" class="panel" aria-hidden="true">
    <div class="data-form">
      <div class="inputs-row">
        <div class="field date">
          <div class="lbl">Дата</div>
          <div class="date-wrap">
            <input type="text" id="dateText" readonly/>
            <div id="cal" class="cal"></div>
          </div>
        </div>
        <div class="field weight">
          <div class="lbl">Тегло (kg)</div>
          <input type="number" id="weight" step="0.1" inputmode="decimal"/>
        </div>
        <div class="field">
          <div class="lbl">БТ</div>
          <div class="ctl">
            <label class="bt-only" title="Спазен режим?">
              <input type="checkbox" id="btFlag" checked/>
            </label>
          </div>
        </div>
        <div class="field">
          <div class="lbl">&nbsp;</div>
          <button id="addBtn" class="primary" type="button">Запис</button>
        </div>
      </div>
    </div>

    <div class="table-wrap">
      <div class="pager" id="pagerTop"></div>
      <table id="tbl">
        <thead>
          <tr>
            <th class="date">Дата</th>
            <th class="w">Тегло</th>
            <th class="act"></th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <div class="pager" id="pagerBottom"></div>
    </div>
    
    <div class="table-opts">
      <label>Редове: 
        <select id="pageSize">
          <option value="7">7</option>
          <option value="14">14</option>
          <option value="28">28</option>
          <option value="84">12 седм.</option>
          <option value="112">16 седм.</option>
          <option value="168">24 седм.</option>
          <option value="336">48 седм.</option>
          <option value="all">Всички</option>
        </select>
      </label>
    </div>

    <div class="chart-section">
      <div class="chart-head">
        <div class="chart-title">Прогрес</div>
        <select id="aggSel">
          <option value="daily">Дневно</option>
          <option value="weekly" selected>Седмично</option>
          <option value="monthly">Месечно</option>
        </select>
      </div>
      <canvas id="chart"></canvas>
    </div>

    <div class="backup-area">
      <button id="exportBtn" type="button">Експорт JSON</button>
      <button id="importBtn" type="button">Импорт JSON</button>
      <input type="file" id="importFile" accept=".json" style="display:none"/>
    </div>
  </div>

  <div id="panel-program" class="panel" aria-hidden="false">
    
    <div class="prog-content">
      
      <div class="prog-section-title">Основен пакет</div>

      <div id="prolact-block" class="prog-block">
        <div class="prog-head">
          <div class="prog-head-main">
            <img src="assets/products/prolact-slim.webp" alt="ProLact Slim+" class="prod-img">
            <div class="prog-pill">
              <div class="prog-cap-main">ProLact Slim+</div>
              <div class="prog-cap-sub">Пробиотик</div>
            </div>
          </div>
          <div class="prog-head-actions">
            <button id="btnProgIntakePL" class="clk-btn intake prog-intake-btn" type="button"></button>
          </div>
        </div>
        <div class="grid-container" id="pl-grid-container">
          <table class="pl-table" id="pl-table">
            <thead>
              <tr>
                <th class="pl-day" data-dow="1">Пн</th>
                <th class="pl-day" data-dow="2">Вт</th>
                <th class="pl-day" data-dow="3">Ср</th>
                <th class="pl-day" data-dow="4">Чт</th>
                <th class="pl-day" data-dow="5">Пт</th>
                <th class="pl-day weekend" data-dow="6">Сб</th>
                <th class="pl-day weekend" data-dow="0">Нд</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>

      <div id="omni-block" class="prog-block">
        <div class="prog-head">
          <div class="prog-head-main">
            <img src="assets/products/omni-hetox.webp" alt="OMNi-Biotic" class="prod-img">
            <div class="prog-pill">
              <div class="prog-cap-main">OMNi-Biotic</div>
              <div class="prog-cap-sub">HETOX light</div>
            </div>
          </div>
          <div class="prog-head-actions">
            <button id="btnProgIntakeHE" class="clk-btn intake prog-intake-btn" type="button"></button>
          </div>
        </div>
        <div class="grid-container" id="he-grid-container">
          <table class="pl-table" id="he-table">
            <thead>
              <tr>
                <th class="pl-day" data-dow="1">Пн</th>
                <th class="pl-day" data-dow="2">Вт</th>
                <th class="pl-day" data-dow="3">Ср</th>
                <th class="pl-day" data-dow="4">Чт</th>
                <th class="pl-day" data-dow="5">Пт</th>
                <th class="pl-day weekend" data-dow="6">Сб</th>
                <th class="pl-day weekend" data-dow="0">Нд</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>

      <div id="chitosan-block" class="prog-block">
        <div class="prog-head">
          <div class="prog-head-main">
            <img src="assets/products/chitosan.webp" alt="Chitosan" class="prod-img">
            <div class="prog-pill">
              <div class="prog-cap-main">Хитозан Плюс</div>
              <div class="prog-cap-sub">Fortex</div>
            </div>
          </div>
          <div class="prog-head-actions">
            <button id="btnProgIntakeCH" class="clk-btn intake prog-intake-btn" type="button"></button>
          </div>
        </div>
        <div class="grid-container" id="ch-grid-container">
          <table class="pl-table" id="ch-table">
            <thead>
              <tr>
                <th class="pl-day" data-dow="1">Пн</th>
                <th class="pl-day" data-dow="2">Вт</th>
                <th class="pl-day" data-dow="3">Ср</th>
                <th class="pl-day" data-dow="4">Чт</th>
                <th class="pl-day" data-dow="5">Пт</th>
                <th class="pl-day weekend" data-dow="6">Сб</th>
                <th class="pl-day weekend" data-dow="0">Нд</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>

      <div class="prog-section-title">Допълнителен пакет</div>

      <div id="ber-block" class="prog-block">
        <div id="ber-head" class="prog-head">
          <div class="prog-head-main">
            <img id="ber-img" src="" alt="" class="prod-img" style="display:none">
            <div class="prog-pill">
              <div class="prog-cap-main" id="ber-cap-main">Берберин</div>
              <div class="prog-cap-sub" id="ber-cap-brand"></div>
            </div>
          </div>
          <div class="prog-head-actions">
            <button id="btnProgIntakeBER" class="clk-btn intake prog-intake-btn" type="button" style="display:none"></button>
            <button id="ber-settings-btn" class="clk-btn settings" type="button">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="3"></circle>
                <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
              </svg>
            </button>
          </div>
        </div>

        <div id="ber-config" class="prog-config-panel" style="display:none">
          <div class="cfg-row">
            <label>Марка:</label>
            <select id="ber-brand-select"></select>
          </div>
          <div class="cfg-row" id="ber-custom-name-field" style="display:none">
            <label>Име:</label>
            <input type="text" id="ber-name" placeholder="Моят продукт">
          </div>
          <div class="cfg-row">
            <label>Приеми дневно: <span class="slider-val" id="ber-slider-val">3</span></label>
            <div class="slider-track-wrapper">
              <div class="slider-track-fill" id="ber-slider-track-fill"></div>
              <input type="range" id="ber-slider" class="slider-control" min="0" max="6" value="3">
            </div>
          </div>
          <div class="cfg-actions">
            <button id="ber-delete" class="cfg-btn danger" type="button">Изтрий</button>
            <button id="ber-save" class="cfg-btn primary" type="button">Запази</button>
          </div>
        </div>

        <div id="ber-grid-container" class="grid-container" style="display:none"></div>
      </div>

      <div id="glu-block" class="prog-block">
        <div id="glu-head" class="prog-head">
          <div class="prog-head-main">
            <img id="glu-img" src="" alt="" class="prod-img" style="display:none">
            <div class="prog-pill">
              <div class="prog-cap-main" id="glu-cap-main">Глюкоманан</div>
              <div class="prog-cap-sub" id="glu-cap-brand"></div>
            </div>
          </div>
          <div class="prog-head-actions">
            <button id="btnProgIntakeGLU" class="clk-btn intake prog-intake-btn" type="button" style="display:none"></button>
            <button id="glu-settings-btn" class="clk-btn settings" type="button">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="3"></circle>
                <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
              </svg>
            </button>
          </div>
        </div>

        <div id="glu-config" class="prog-config-panel" style="display:none">
          <div class="cfg-row">
            <label>Марка:</label>
            <select id="glu-brand-select"></select>
          </div>
          <div class="cfg-row" id="glu-custom-name-field" style="display:none">
            <label>Име:</label>
            <input type="text" id="glu-name" placeholder="Моят продукт">
          </div>
          <div class="cfg-row">
            <label>Приеми дневно: <span class="slider-val" id="glu-slider-val">3</span></label>
            <div class="slider-track-wrapper">
              <div class="slider-track-fill" id="glu-slider-track-fill"></div>
              <input type="range" id="glu-slider" class="slider-control" min="0" max="6" value="3">
            </div>
          </div>
          <div class="cfg-actions">
            <button id="glu-delete" class="cfg-btn danger" type="button">Изтрий</button>
            <button id="glu-save" class="cfg-btn primary" type="button">Запази</button>
          </div>
        </div>

        <div id="glu-grid-container" class="grid-container" style="display:none"></div>
      </div>

      <div id="egc-block" class="prog-block">
        <div id="egc-head" class="prog-head">
          <div class="prog-head-main">
            <img id="egc-img" src="" alt="" class="prod-img" style="display:none">
            <div class="prog-pill">
              <div class="prog-cap-main" id="egc-cap-main">Зелен чай (EGCg)</div>
              <div class="prog-cap-sub" id="egc-cap-brand"></div>
            </div>
          </div>
          <div class="prog-head-actions">
            <button id="btnProgIntakeEGC" class="clk-btn intake prog-intake-btn" type="button" style="display:none"></button>
            <button id="egc-settings-btn" class="clk-btn settings" type="button">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="3"></circle>
                <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path>
              </svg>
            </button>
          </div>
        </div>

        <div id="egc-config" class="prog-config-panel" style="display:none">
          <div class="cfg-row">
            <label>Марка:</label>
            <select id="egc-brand-select"></select>
          </div>
          <div class="cfg-row" id="egc-custom-name-field" style="display:none">
            <label>Име:</label>
            <input type="text" id="egc-name" placeholder="Моят продукт">
          </div>
          <div class="cfg-row">
            <label>Приеми дневно: <span class="slider-val" id="egc-slider-val">3</span></label>
            <div class="slider-track-wrapper">
              <div class="slider-track-fill" id="egc-slider-track-fill"></div>
              <input type="range" id="egc-slider" class="slider-control" min="0" max="6" value="3">
            </div>
          </div>
          <div class="cfg-actions">
            <button id="egc-delete" class="cfg-btn danger" type="button">Изтрий</button>
            <button id="egc-save" class="cfg-btn primary" type="button">Запази</button>
          </div>
        </div>

        <div id="egc-grid-container" class="grid-container" style="display:none"></div>
      </div>

    </div>
  </div>

  <div class="clk" id="clk" aria-hidden="true">
    <div class="clk-card" id="clkCard">
      <button id="btnCloseClk" class="clk-close-btn" type="button" aria-label="Затвори">
        <svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>

      <div class="clk-info">
        <div class="clk-prod-name" id="clk-product">Продукт</div>
        <div class="clk-weekday" id="clk-weekday">Понеделник</div>
      </div>
      
      <div class="clk-face" id="clkFace">
        <div class="clk-ring-h" id="ringH"></div>
        <div class="clk-ring-m" id="ringM"></div>
        <div class="clk-center"></div>
        <div class="clk-hand h-hand" id="handH"></div>
        <div class="clk-hand m-hand" id="handM"></div>
      </div>

      <div class="clk-read" id="clkRead">
        <div class="clk-part" id="clkH"></div>
        <div class="clk-sep">:</div>
        <div class="clk-part" id="clkM"></div>
      </div>
      <input type="text" id="clkKeyInput" class="clk-hidden-input" inputmode="numeric" pattern="[0-9]*" autocomplete="off">

      <div class="clk-actions">
        <div class="clk-actions-row">
          <div class="clk-actions-group">
            <button id="btnIntake" class="clk-btn intake big" type="button" title="Статус на приема">
               <span class="clk-btn-icon">
                <svg viewBox="0 0 24 24" class="pill-clock-svg">
                  <circle cx="12" cy="12" r="10" class="pill-clock-circle"></circle>
                  <path d="M12 6v6l4 2" class="pill-clock-hands"></path>
                  <rect x="15" y="4" width="6" height="12" rx="3" transform="rotate(30 18 10)" class="pill-clock-pill"></rect>
                </svg>
               </span>
            </button>
            <button id="btnSaveOne" class="clk-btn primary" type="button" title="Запис само за този ден">
              <span class="clk-btn-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                  <path d="M20 6L9 17l-5-5"></path>
                </svg>
              </span>
            </button>
            <button id="btnSaveAllDays" class="clk-btn primary" type="button" title="Запис за всички дни от този ред">
              <span class="clk-btn-icon">
                <svg viewBox="0 0 24 24" fill="none">
                  <path d="M4 13l3 3 5-7"></path>
                  <path d="M11 13l3 3 6-8"></path>
                </svg>
              </span>
            </button>
          </div>
          <button id="btnAudio" class="clk-btn audio big" type="button" title="Аудио вкл/изкл за този час">
            <span class="clk-btn-icon">
              <svg viewBox="0 0 24 24" fill="none">
                <g class="icon-sound">
                  <path d="M5 9v6h3l4 4V5L8 9H5z"></path>
                  <path d="M16 9a3 3 0 0 1 0 6"></path>
                </g>
                <g class="icon-mute">
                  <path d="M5 9v6h3l4 4V5L8 9H5z"></path>
                  <path d="M18 9l-4 4m0-4l4 4"></path>
                </g>
              </svg>
            </span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <template id="tmpl-grid">
    <table class="pl-table">
      <thead>
        <tr>
          <th class="pl-day" data-dow="1">Пн</th>
          <th class="pl-day" data-dow="2">Вт</th>
          <th class="pl-day" data-dow="3">Ср</th>
          <th class="pl-day" data-dow="4">Чт</th>
          <th class="pl-day" data-dow="5">Пт</th>
          <th class="pl-day weekend" data-dow="6">Сб</th>
          <th class="pl-day weekend" data-dow="0">Нд</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </template>

  <script type="module" src="assets/js/main.js"></script>
  <script type="module" src="assets/js/data.js"></script>
  <script type="module" src="assets/js/program-init.js"></script>
  <script type="module" src="assets/js/program-additional.js"></script>

  <script>
    if('serviceWorker' in navigator){
      navigator.serviceWorker.register('sw.js')
        .then(reg => console.log('SW registered', reg.scope))
        .catch(err => console.log('SW failed', err));
    }
  </script>
</body>
</html>